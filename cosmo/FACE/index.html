<!DOCTYPE html>
<html lang="en" >

<head>
  <title>COSMO</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="output" style="color: white;"></div>
    <script src="https://cdn.ably.com/lib/ably.min-2.js"></script>
    <script>
        const output = document.getElementById('output');

        function log(message) {
            output.innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }

        async function getStarted() {
            const realtimeClient = new Ably.Realtime({
                key: 'CClXdw.Z3P7Fw:G1W_WXLZYUpqqnjvplbv_GDmUJ3TB4lk1bs54DblqpE',
                clientId: 'cosmo_face'
            });

            await realtimeClient.connection.once('connected');
            //log('Made my first connection!');

            const channel = realtimeClient.channels.get('cosmo_face');

            await channel.subscribe((message) => {
                //log(`Received message: ${message.data}`);

                // If the message is "smile", make COSMO happy
                if (message.data === 'smile') {
                    eyes.express({ type: 'happy' });
                }
                // Blinking
                if (message.data === 'blink') {
                    eyes.blink()
                }
                // Other emotions
                if (message.data === 'sad') {
                    eyes.express({ type: 'sad' });
                }
                if (message.data === 'angry') {
                    eyes.express({ type: 'angry' });
                }
                if (message.data === 'focused') {
                    eyes.express({ type: 'focused' });
                }
                if (message.data === 'confused') {
                    eyes.express({ type: 'confused' });
                }
                if (message.data === 'startBlinking') {
                    eyes.startBlinking()
                }            
                if (message.data === 'stopBlinking') {
                    eyes.stopBlinking()
                }                                                 
            });
        }

        getStarted();
    </script>  

    <!-- Uncomment for designiing new emotions
    <div class="buttons">
        <button onclick="eyes.express({type: 'happy'})">Smile</button>
        <button onclick="eyes.blink()" >Blink</button>        
        <button onclick="eyes.express({type: 'sad'})">Sad</button>
        <button onclick="eyes.express({type: 'angry'})">Mad</button>
        <button onclick="eyes.express({type: 'focused'})">Focused</button>
        <button onclick="eyes.express({type: 'confused'})">Confused</button>
        <button onclick="eyes.startBlinking()">Start Blinking</button>
        <button onclick="eyes.stopBlinking()">Stop Blinking</button>        
    </div>
    -->

    <div class="face">
        <div class="eye left">
            <div class="eyelid upper"></div>
            <div class="eyelid lower"></div>
        </div>
        <div class="eye right">
            <div class="eyelid upper"></div>
            <div class="eyelid lower"></div>
        </div>
        <div class="mouth"></div>
    </div>

    <script  src="index.js"></script>
</body>